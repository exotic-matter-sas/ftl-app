{% extends 'account/account_base.html' %}
{% load i18n %}

{% block account %}
    <h3 class="text-primary">{% trans "Confirm your authenticator app" %}</h3>
    <p>{{ object }}</p>

    {% if not object.confirmed %}
        <p>{% trans "Scan the following QR code with the authenticator app" %}</p>


        <p><img src="{% url 'otp_totp_qrcode' object.id %}" alt="qrcode"/></p>

        <p class="highlight">
            {% blocktrans %}
                Confirm that you have successfully configured your authenticator app by writing the current code in the
                form below.
            {% endblocktrans %}
        </p>

        <form action="" method="post">
            {% csrf_token %}

            <div class="form-group">
                <label for="id_otp_token">Code</label>
                <input type="text" name="otp_token" value="" placeholder="XXX XXX" required="required" id="id_otp_token"
                       class="form-control">
                <small class="form-text text-muted">{% trans 'Code shown in your auth app' %}</small>
            </div>

            <input type="submit" class="btn btn-primary" value="{% trans "Validate" %}">
        </form>
    {% endif %}

    <p class="text-right"><a href="{% url 'otp_list' %}">{% trans 'Return to 2FA list' %}</a></p>
{% endblock %}
