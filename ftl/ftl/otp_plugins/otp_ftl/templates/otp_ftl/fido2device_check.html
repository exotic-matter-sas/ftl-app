{% extends "ftl/main_with_aside.html" %}
{% load i18n %}
{% load static %}

{% block title %}{% trans "Two-step Verification" %}{% endblock %}
{% block head %}
    <script type="application/javascript" src="{% static 'cbor.js' %}"></script>
{% endblock %}

{% block main_content %}
    <h1 class="text-primary">
        {% trans "Two-step Verification" %}
    </h1>

    <p>{% trans "This extra step shows that itâ€™s really you trying to sign in" %}</p>

    {% if have_fido2 %}
        <form method="post" id="user-form">
            {% csrf_token %}
            {{ form.as_p }}

            <input class="btn btn-lg btn-primary btn-block" type="submit" value="{% trans "Verify" %}">
        </form>
    {% else %}
        <p>{% trans "Error: you can't use a security key on this account" %}</p>
    {% endif %}

    {% if have_totp or have_static %}
    <p>{% trans "Try another way" %}</p>
    <ul>
        {% if have_totp %}
            <li><a href="{% url "otp_totp_check" %}">{% trans "Use a code from your authentication app" %}</a></li>
        {% endif %}
        {% if have_static %}
            <li><a href="{% url "otp_static_check" %}">{% trans "Use a one time emergency code" %}</a></li>
        {% endif %}
    </ul>
    {% endif %}
{% endblock %}

{% block aside_illustration %}
    <img src="{% static "user_setup.svg" %}" alt="Signup steps illustration">
{% endblock %}


{% block footer %}
    {% if have_fido2 %}
        <script type="application/javascript" src="{% static 'fido2_form.js' %}"></script>
    {% endif %}
{% endblock %}

